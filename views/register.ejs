<%- include('partials/header') %>

<div class="min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">
    <div class="w-full max-w-md glass p-8 rounded-3xl shadow-2xl border-t border-white/10 animate-slide-up">
        
        <div class="mb-6">
            <h2 class="text-2xl font-bold text-white">Create Account</h2>
            <p class="text-gray-400 text-xs mt-1">Join the community today.</p>
        </div>

        <form action="/register" method="POST" class="space-y-4">
            <div class="relative group">
                <i data-lucide="user" class="absolute left-4 top-3.5 text-gray-500 w-5 h-5 group-focus-within:text-primary-500 transition"></i>
                <input type="text" name="username" placeholder="Username" required class="w-full bg-dark-800/50 border border-dark-700 text-white rounded-xl pl-12 pr-4 py-3.5 focus:border-primary-500 outline-none transition">
            </div>

            <div class="relative group">
                <i data-lucide="mail" class="absolute left-4 top-3.5 text-gray-500 w-5 h-5 group-focus-within:text-primary-500 transition"></i>
                <div class="flex gap-2">
                    <input type="email" id="emailInput" name="email" placeholder="Email" required class="flex-1 bg-dark-800/50 border border-dark-700 text-white rounded-xl pl-12 pr-4 py-3.5 focus:border-primary-500 outline-none transition">
                    <button type="button" onclick="requestOtp()" id="otpBtn" class="bg-primary-600/80 hover:bg-primary-600 text-white px-4 rounded-xl text-xs font-bold transition flex items-center gap-1">
                        <i data-lucide="send" class="w-3 h-3"></i> OTP
                    </button>
                </div>
            </div>
            
            <div id="otpStatus" class="text-[10px] text-gray-400 pl-1 h-4 flex items-center gap-1"></div>

            <div class="relative group">
                <i data-lucide="key" class="absolute left-4 top-3.5 text-gray-500 w-5 h-5 group-focus-within:text-primary-500 transition"></i>
                <input type="number" name="otp" placeholder="Enter OTP Code" required class="w-full bg-dark-800/50 border border-dark-700 text-white rounded-xl pl-12 pr-4 py-3.5 focus:border-primary-500 outline-none font-mono tracking-widest">
            </div>

            <div class="relative group">
                <i data-lucide="lock" class="absolute left-4 top-3.5 text-gray-500 w-5 h-5 group-focus-within:text-primary-500 transition"></i>
                <input type="password" name="password" placeholder="Create Password" required class="w-full bg-dark-800/50 border border-dark-700 text-white rounded-xl pl-12 pr-4 py-3.5 focus:border-primary-500 outline-none transition">
            </div>

            <button type="submit" class="w-full bg-white text-dark-900 font-bold py-3.5 rounded-xl hover:bg-gray-200 transition mt-4 transform active:scale-[0.98]">
                Get Started
            </button>
        </form>
        
        <div class="mt-6 text-center text-xs text-gray-500">
            <a href="/login" class="flex items-center justify-center gap-1 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-3 h-3"></i> Back to Login
            </a>
        </div>
    </div>
</div>

<script>
    lucide.createIcons();
    async function requestOtp() {
        // Logic OTP sama (hanya update status icon)
        const email = document.getElementById('emailInput').value;
        const btn = document.getElementById('otpBtn');
        const status = document.getElementById('otpStatus');
        
        if(!email) { 
            status.innerHTML = `<i data-lucide="x-circle" class="w-3 h-3 text-red-400"></i> <span class="text-red-400">Email required</span>`; 
            lucide.createIcons(); return; 
        }
        
        btn.innerHTML = `<i data-lucide="loader-2" class="w-3 h-3 animate-spin"></i>`; 
        btn.disabled = true;

        try {
            const res = await fetch('/send-otp', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({email}) });
            const d = await res.json();
            if(d.success) {
                status.innerHTML = `<i data-lucide="check-circle" class="w-3 h-3 text-green-400"></i> <span class="text-green-400">${d.message}</span>`;
            } else {
                status.innerHTML = `<i data-lucide="x-circle" class="w-3 h-3 text-red-400"></i> <span class="text-red-400">Failed</span>`;
            }
        } catch { status.innerText = "Error"; }
        btn.innerHTML = "Resend"; btn.disabled = false; lucide.createIcons();
    }
</script>
</body>
</html>